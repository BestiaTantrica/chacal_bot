# üìú PROTOCOLO DE SUPERVIVENCIA "CHACAL" - REGLAS DE ORO

## ‚öñÔ∏è LEY CERO: RENTABILIDAD SOBRE VELOCIDAD

**ESTE REPOSITORIO OPERA BAJO RIESGO DE CAPITAL REAL.**

- **PROHIBIDO EL USO DE DATOS GEN√âRICOS**: Prohibido inyectar par√°metros de ejemplo. Si falta data de Hyperopt, el Agente **PARA** y pregunta.
- **CAPITAL SAGRADO**: Total Dry Run = **$300 USD**.
- **RENTABILIDAD ES PRIORIDAD**: No importa qu√© tan r√°pido se despliegue; si no es rentable con datos reales, no sirve.

**ESTE DOCUMENTO ES DE LECTURA OBLIGATORIA PARA EL AGENTE ANTES DE CUALQUIER COMANDO.**

## 1. RESTRICCIONES DE HARDWARE (AWS t2.micro)

- **CONTENEDORES**: Siempre usar **Docker**. No correr procesos pesados nativos.
- **RAM**: 1GB (Saturada). No cargar m√°s de 120-150 d√≠as de datos 5m.
- **CPU**: 1 Core. **PROHIBIDO** usar `-j 2`. Siempre usar `-j 1`.
- **SWAP**: 4GB activos. Evitar procesos que lo saturen para no congelar la instancia (Load Average < 2.0 ideal).

## 2. REGLAS DE CONFIGURACI√ìN (CR√çTICAS)

- **HARDWARE (t2.micro)**: Limitar a 3 pares para no colapsar la RAM.
- **SINTAXIS FUTURES**: En Binance Futures, los pares DEBEN usar el formato `PAR/USDT:USDT` (no `PAR/USDT`). Esto aplica para configs, whitelists y comandos.
- **RESOLUCI√ìN DE CAZA (1m)**: El Hyperopt se ejecuta SIEMPRE a 1 minuto para detectar el gatillo en las Horas M√°gicas. El refinado a 5m es solo para el despliegue final.
- **ESTRATEGIA √öNICA**: Solo `ChacalPulseV4_Hyperopt`.
- **SHORTS OBLIGATORIOS**: Siempre configurar `"can_short": true`.
- **ZOMBIES**: PROHIBIDO dejar contenedores con nombres aleatorios. El despliegue siempre debe ser v√≠a `docker-compose_relevo.yml` para nombres fijos.

## 3. REGLAS DE ESTRATEGIA (CHACAL V4)

- **HORAS M√ÅGICAS**: Operar exclusivamente en las aperturas: Londres (08-10 UTC / 05-07 Local) y New York (13:30-17:30 UTC / 10:30-14:30 Local).
- **ADAPTACI√ìN**: La estrategia DEBE diferenciar entre BULL, BEAR y LATERAL mediante indicadores (ADX/RSI).
- **HYPEROPT**: Optimizar par√°metros de salida espec√≠ficos para cada uno de los 3 estados.

## 4. CICLO DE VIDA Y RECURSOS (CR√çTICO)

- **USO DE TIEMPO**:
  - **Horas M√°gicas**: Trading activo (Caza).
  - **Horas Muertas**: Apagar trading y procesar **Hyperopts moneda por moneda** hasta hallar la configuraci√≥n ganadora.
- **FINES DE SEMANA**: Reservados exclusivamente para **Pruebas y Optimizaci√≥n**. NUNCA dejar bots corriendo a lo loco.
- **PERSISTENCIA**: No dejar procesos "viviendo" sin control. Si no hay estrategia ganadora validada, el bot NO OPERA.

## 5. PROCEDIMIENTO DE HYPEROPT (EST√ÅNDAR DE ORO)

1. **Metodolog√≠a de Refinado (1m -> 5m)**:
   - **Fase 1 (Precisi√≥n)**: Uso de **Biblioteca Quir√∫rgica 1m**.
   - **Fase 2 (Refinado)**: Estabilidad en 5m. Para operar sin que nos maten las comiciones.
2. **Biblioteca Quir√∫rgica (1m Magic)**:
   - **Segmentaci√≥n**: Solo se procesan velas de 1m correspondientes a las Horas M√°gicas (+warmup).
   - **Capacidad Permanente**: Se mantendr√° un repositorio hist√≥rico de hasta **7 a√±os** en el directorio `binance_surgical`.
   - **Eficiencia**: 12 pares √ó 6 horas/d√≠a √ó 1m ‚âà 6GB de disco para una d√©cada de datos t√°cticos. Esto evita re-descargas y ahorra ancho de banda.
   - **Mantenimiento**: Cada fin de semana se "poda" la data nueva descargada para integrarla a la Biblioteca Quir√∫rgica.
3. **Fase 2: Refinamiento (5m - Industrial)**: ‚úÖ **COMPLETADA 2026-02-08**
   - **Objetivo**: Validar robustez de par√°metros con horizonte temporal extendido.
   - **Datos**: 365 d√≠as @ 5m filtrada por **Horas M√°gicas** (Londres + NY).
   - **Intensidad**: 1000 √©pocas por moneda.
   - **Ejecuci√≥n**: Secuencial (1 moneda por vez) para evitar OOM en t2.micro.
   - **Resultados Destacados**:
     - LINK: +196.35% (463 trades, 63.5% WR)
     - NEAR: +140.81% (292 trades, 76.0% WR)
     - SUI: +106.95% (268 trades, 70.1% WR)
     - DOGE: +105.29% (281 trades, 70.8% WR)
   - **Script**: `user_data/lanzar_fase2_final.sh`.
   - **Lecci√≥n Clave**: La combinaci√≥n 1m (exploraci√≥n) + 5m (validaci√≥n) es superior a optimizar directamente en 5m.
4. **Pares (Batall√≥n Elite - 12 Unidades)**:
   - **Selecci√≥n**: BTC, ETH, SOL, XRP, ADA, DOT, DOGE, AVAX, LINK, BNB, SUI, NEAR.
   - **Criterio**: Monedas de Tier 1/2 con correlaci√≥n real con BTC y volumen masivo para 1m. SUI y NEAR elegidas por su performance actual en el mercado.
5. **Cola de Ejecuci√≥n (Secuencial)**:
   - **Problema**: El Hyperopt de 12 monedas es inejecutable en 1GB de RAM de forma simult√°nea.
   - **Soluci√≥n**: Se usa el script `user_data/cola_hyperopt.sh` para procesar **una moneda por vez**.
   - **Persistencia**: Se lanza bajo `screen -dmS hyperopt_ELITE` para operar de forma aut√≥noma.
6. **Estructura de Datos (Biblioteca Quir√∫rgica)**:
   - **Ubicaci√≥n Nativa**: `user_data/data/binance/futures/`.
   - **Formato**: `feather` (m√°xima velocidad de lectura).
   - **Injerto**: Para que Freqtrade reconozca los datos segmentados, deben residir en la ruta nativa y estar acompa√±ados de los archivos `funding_rate.feather` y `mark.feather` originales.

## 7. GESTI√ìN DE INCIDENCIAS Y RESCATE (REGLAS DE HIERRO)

- **SATURACI√ìN**: Si el Load Average > 10.0 o RAM < 50MB, realizar `sudo docker stop $(sudo docker ps -q)` inmediatamente.
- **SABOTAJE DE SHELL**: En PowerShell, los comandos remotos con expansiones `$(...)` deben enviarse entre comillas simples o dobles escapadas para evitar que se ejecuten localmente.
- **RESCATE FORENSE**: Si el servidor se cuelga, el archivo `.fthypt` es la √∫nica fuente de verdad; usar `cat` para verificar integridad antes de intentar procesos pesados.
- **BACKUP PREVENTIVO**: Descargar el log (`SCP`) cada 4 monedas procesadas para no depender de la persistencia del servidor al final de la jornada.

## 8. GESTI√ìN DE ENERG√çA Y SUPERVIVENCIA (FREE TIER) ‚úÖ

- **ENCENDIDO (AWS Scheduler)**:
  - **Londres (04:55 AM ART)**: Regla `Chacal_PowerOn_Londres` (Cron: `55 7 ? * MON-FRI *`).
  - **NY (10:25 AM ART)**: Regla `Chacal_PowerOn_NY` (Cron: `25 13 ? * MON-FRI *`).
  - **Permisos**: IAM Role `ChacalPowerRole` con `AmazonEC2FullAccess`.
- **APAGADO (Vigilante)**:
  - Script `vigilante_energia.py` escaneando los 4 SQLite cada 5 min.
  - Horarios de check cr√≠ticos: **07:15 ART** y **14:45 ART**.
  - **L√≥gica**: Si detecta trades abiertos o el archivo `/tmp/NO_APAGAR`, el apagado se **cancela**.
- **DESPLIEGUE MULTI-TORRE (t2.micro)**:
  - **Alpha**: BTC, ETH, SOL | **Beta**: BNB, XRP, ADA
  - **Gamma**: DOGE, AVAX, LINK | **Delta**: DOT, SUI, NEAR
  - Arranque autom√°tico v√≠a `@reboot` en crontab llamando a `lanzar_torres.sh`.

## 9. ARQUITECTURA T√âCNICA (MANUAL PARA IA/HUMANO) üìï

### L√≥gica de Trading (ChacalPulseV4)

- **Gate Horario**: El bot calcula indicadores 24/7 pero solo abre la "reja" (`gate_open`) en ventanas de Londres y NY.
- **Modos**: `hunter` (solo ventanas) vs `vigilante` (siempre activo - opcional).
- **Reg√≠menes**: ADX/RSI detectan tendencia. El bot cambia Stoploss y ROI sobre la marcha (Bull/Bear/Lateral).

### Infraestructura (t2.micro - Relevo V4)

- **Torres Docker**: 4 contenedores (Alpha, Beta, Gamma, Delta) dividiendo 12 monedas por RAM.
- **Vigilante Energ√≠a**: Script `vigilante_energia.py` escanea los 4 SQLite. El apagado se cancela si hay trades vivos.
- **Arranque**: `lanzar_torres.sh` se ejecuta `@reboot`.

---
**Misi√≥n: Recuperar el capital con disciplina y precisi√≥n.**
